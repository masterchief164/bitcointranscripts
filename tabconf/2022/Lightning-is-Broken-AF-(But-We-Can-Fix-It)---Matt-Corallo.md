---
title: Lightning is Broken AF (But We Can Fix It) - Matt Corallo
transcript_by: masterchief164 via TBTBTC v1.0.0
media: https://www.youtube.com/watch?v=s9KMRWkcwtE
date: 2022-11-07
---

 being still the direction of macroeconomic, you may know of inspiring, probably, many other things. It's each day, this presentation of title lightning is broken at a spot, but we can fix it without further ado. Who's that? It's a little bit dramatic, thank you. Thank you. Yeah, so as the title says, for those of you who work in lightning or been around lightning for a long time, hopefully you will recognize basically all issues on those of today, and go through a very long list of things. But I'll try to go through most of the kind of 50s, my understanding of the current thinking of solutions for a lot of these issues. So hopefully that most people will just have a chance to learn something, or at least get some better idea of where things are going, even if you already know all the issues. Some of these issues should be a little complex. I'm going to try to explain them the best I can, I'm not always the best at explaining things. If you're confused, please do an erupting. Throw something at me, clearly throwfully loud, just yell a question, and I'm okay with all of that. Just, I want to make sure everyone's on the same page with the end of this, so feel free to interrupt me as we go rather than holding a question at the end, if I'm not making something entirely clear. So yeah, I mean, lighting is obviously more quickly. People are not sure if there's all kinds of things, changes and people are saying, painting them, the US is actually good. You're like, pay for something, painting it for people, so for lighting at this point, because lighting makes it actually easier now. But a lot of that should get out of your curve. To develop it, could you move? There's a lot of people working on lighting, a lot of really people working on lighting, but lighting is got the big, and it's kind of hard to make progress very quickly. So it moves, it moves, it moves, it moves, it moves, it moves, we don't want to break our lines or anything. But there's still lots and lots of issues, we're going to talk about a bunch. And we got that, you know, we have to improve these issues, but without breaking things and that makes lightening, development still kind of early, even though the adoption is showing a lot of progress. So, you know, everyone who's been around lighting, those lighting, of course, we're going to be able to do the right to be on my all the time. You're going to check the blockchain every now and again, and you got those sophisticated time outs, and stuff you got to be able to go to the chain. You know, really lighting, everyone excited that this was fine. And we're going to salt this by putting your dough in your wrist, my home. This is a great bottle, it's really cool. You keep the wrist very tight, put it all the time. You're going to have to go to the home, I don't know. Or you guys live that you're going to have to go to the pay whatever. And you can keep your wrist right behind the home, it's great. And then you're in Florida and you're in a hurricane, and suddenly you're going to have to raise your eyes off line, and so much still with your money. But it's okay, because you lost your house too. So, you just wanted that extra payment suffering that week. Okay, so well, you don't put it on your wrist very fast. That's a thing for some people, for others, you can do too much. Maybe it was one of the cloud, right? So, this is great cloud service providers. You can pay them some money every month, they'll keep our service online. It's also on each other's over at K-1 US East, and then these higher accounts down on. So, it makes you not alone, but you just do as money as something. It doesn't matter. Or maybe you used, I don't know, there's a bunch of bad services that someone contact support. Tell us about the loss of their account, and they still get your money, because support helps you to less the media account. This is only half of a handful of times, but you don't want to be that kind of a bad screw. Okay, well, maybe let's put it on cloud of them, cloud of kind of sucks. Okay, well, turns out, what's used is like mobile phones. Mobile phones are great, everyone actually wants the normal insurance, what they're used to, use it, use it, kind of want this experience, that they're used to doing install on that, and suddenly they have had all the stuff works in the app. To do all these things are actually just blank clients who are server, and we didn't want to go to Stoignol, so, maybe that's not great, but basically we can make apps work, maybe we can get the link in the app, and we're not going to have to draw that instead. It's two type of users, some people shaking, like out of the woods, I don't know why, you would leave your basement, but some people do it on toll. And then there's a full cuffline, so three days, and then lost their money again. So, or actually it turns out this problem is more nuanced, not that simple, there's two issues here, right? So, there's the sign that you have to be online, you have to check in every day, or meet, or what have you, you could change the time, 40 was the number until the bug last week, and I'll be, but now it's going to be tired, so, so you're going to have to check in, only once a day and a game, so, okay, maybe we can do that, maybe the phone is probably online once a day. It turns out you also need to be online or see the payment, so, like, right from that payment comes in, you want to be online to actually see it. That's really great, but phone, you can get push notifications, your app can run, oh, no, actually, it doesn't work that, right? So, phones are very conservative values, the app's you open all the time, if you're always on your big one wallet, you'll probably get to see if you use it from the notification comes in, the notification will come in, and then, can wake up, you can do some work, you know, we are in, we're in the base, you'll see it, you can claim the payment. Good, if you only open the app once a month, the phone is especially in iOS, I really don't want to give you any CPU time. They're just in the user doesn't use the app much, CPU waste battery, especially in AppleX's waste battery, and so that would be really bad user experience for users that they're battery, constraint, you know, I mean, you're a pain, you're in the money, but I don't mean you can't take the battery, so, so, you choose a yours, you can't do that a lot of times. So, this is a new one, so, I'll just kind of do two sides of it. So, okay, well, sending, I mean, when you sender to the camera, you send the payment, you probably have the app open, please, that's not actually a problem, but you'll see a payment, that's a problem. So, in plain name, right, we're sending these payments to the multiple hops, you know, hopefully many hops for privacy for five hops, but you're sending a name, you're sending these each field seed rate. So, along the entire path, you have to lock in money, you have to commit some portion of the channel, total available resources to this pending payment, and that phone and theory here needs to be online to say, hey, now I'll clear the payment, now you're not holding these resources hostage. The phone's not online, you're holding these resources, obviously it's the whole time, this is terrible. Okay, so what do we do? There's this, we've now read a brand of the nascent payments, what we're going to call it, there's this is all proposal that I had to solve this problem. Kind of, the intuition is basically just the phone and tells the sender when it's online, it's not that complicated. It's not that complicated, that theory. And prior to this, it's very complicated. So, we actually need, like, layers of things we need to be able to get to the point where we can do this, so we need money and messages, so money and messages are really great platform. How is there a receiver going to tell the sender when it's online, without revealing the would-is? Yeah, that's hard, but we had this great, flaking out work, we have, we have, we have, we have, we have, we have, we have, we have payments to them, so we choose you on the MSX, we can't have the send messages but we're relating. They're finally coming, you know, I think the, clear has it like, why, turn on the bed default, clearly, it has it live, but like, if turn on the flag, because it's still kind of data, but they were leaving the bed first, so I think it's too much should. I'll leave you now, has it, we're working on some of the finishing touches for it, but looking forward to the payments, or forward messages, so we can send these messages to the same hand online, something you'll see now, okay, well, that's great. But it would about retrotor sending to the user, the oldens, the phone, sends the payment, and then the payment fails, because the route, well, it wasn't a, it was pretty deep on the route, and then they've closed the output in the project, and then oops, now we can't retract, well that sucks. Okay, well, how do we retract, well, we have, uh, trampoline, trampoline's great, so there's the new trampoline for, um, forever at this point, and you send the payment to the LSD, the immediate first hop, you tell it were intended, oh wait, crap, we didn't want to tell the server where we're sending all our payments, uh, bad for privacy. Alright, well, we'll do this trampoline thing, and we'll have multiple trampoline hops, alright, we'll get there a little bit. Um, okay, well that's one more thing we need to build for ace payments, we gotta have trampoline, so that we can send it to the first hop, and tell the first hop where it got the payment, and you can retract it for us, even as the phones offline. Um, okay, well, what about, um, some of the users really love this user experience, something with that model, the camera, the phone, and other things, you can QR code, and you can, like, put that QR code on Twitter, and then people can just scan that QR code in sentient money. Uh, to really, really experience people love it, wait and you should try this, um, in terms of, you can't do that, because it's bit invoices or single use, uh, that's irrelevant. Um, okay, so we wanna have multi-use invoices, where there's simply it can be offline, where we wanna send the payment, and then it just tells the sender when it comes online. Okay, so we need, on the messages we're in trampoline, uh, oh, single use out, we need ptl seats, so not only that we need, uh, so we need the sender to be able to create the payment and so the, you know, on the, uh, the HTTile C construction and lightning, uh, you have to have the hash and pre-imagine the hash that the recipient reveals to the sender in order to clear the payment. Um, there's an old proposal to use short signature as an ads, now it's taboo, we can actually input this, something in, uh, but we can, uh, swap the hash and the pre-imagine for, uh, or call it that, so you're gonna have to not have to work, but we can do magic and, uh, easy land and an old decur, and we can use actual signature to score it, and it actually loves the sender to say, hey, uh, we're sending it, you give me this awesome, uh, public key, but then, you know, similar to the payment actually lightning, I'm gonna actually add my old little bit to it, and then it's unique so that we can't use a payment hash for the ones, so you have to have it has to be unique. So the sender can add a little information to it, um, and now we get this great, uh, single QR code, and experience with offline receiving, and we only need to build three massive features that we're collecting to get it there, and then we also need to see follow-up things. We'll get it one day at promise. Okay, so that's easy payments. All right, so we've solved the always-limiting problem, right? Oh, wait, it turns out sometimes software has bugs, it happens to all of us, we've all done it, and then your nose offline, and now you can't force station, we'll see, who says this problem. Okay, so, as we've all learned this week, your time-lapse and your lightning signs has to be at least your response time, so there's a bug in your nose, has to be time-flid at all, there's a fix in your shoe, ship a patch, and you got to apply the patch, uh, make sure your time in your time-lapse, and play the thing our well tuned to do just that. Oh, okay, well, it turns out, you know, we have this watch, I watched Harry Stakes on the Grand Lungs with, uh, being online all the time, I've heard, and that's what I've been told. Um, yeah, it must have been real-sees, so if you have me, you'll see the watch stars, actually don't, don't fix your problems, oops. Um, yeah, so, do some of the live-in models for watch showers, right? So there's the kind of, you've probably heard watch showers, that use like super red things that always make sure you're going to get your money back, um, that's one model, that doesn't actually force all the conditions, but the super red version of watch showers, right? You send it like a list of, basically, you know, if you see this transaction on the chain, here's some other transaction, sub-rock cast, that's super awesome. Uh, it's super private because they actually don't learn anything unless they see those transactions on the chain. Uh, so that's not actually the full-length, being trust model if you have an e-sheel-z, so in lighting, where you have your 48-day length, or you see what they have on the outside, you have to forward it down on another, if you're a big graduate note, um, if you go to the chain, if those channels go to the chain and, uh, the upstream channel goes to the chain, and they reveal the pre-image for this H-t-l-z, clearing the H-t-l-z, getting the money from you. Um, Jane, you have to see that pre-image, take that pre-image, and then back to the note before you, that you received the payment from me before we got to. Uh, you have a watch for what you don't do that. Um, especially since they want to be private, ideally, and you have to reveal information about your individual channels. You have to tell them like, hey, this is my upstream channel, this is my downstream channel, the payment that I was forwarding at this payment has shown, came from this channel, I went to that channel and here's how you broadcast the Korean state for that other channel, and we're able to payment for the image, and that would be entirely not private in any way, should it perform in the flash shower, but we're going to everything about what's happening in your channel. Um, yeah, well, anything you can do that. So, so, baby watch right, you know, should consider you're interested to watch hours, and should actually run their note as small-full independent machines that are actually running these kinds of pseudo-launched hours that are actually running or getting about the revenue note, but when you actually think about running a watch shower as many of them are implemented, today there's some private that's super great, but keep in mind that they can't enforce each KLC state, so you might want to consider changing your max HCl scheme, and flake limit so that you're only ever exposed to a smaller amount of Everest because you only allow a certain amount of money moving through your note at once. Um, let's see, so I've heard a watch shower problems or I'll fix with all two of them, right? Watch showers, can't scale, and they have to sort of much data and L2 is the straight view, proposed, it will probably actually some of the dance of software. Because it's a change, a big point to the point, it allows us to store only one little bit of constant side thing with the watch shower, and we don't have to store all of this little historical state, you know, watch shower, data storage, rows, as the channel seat. We've stored it in time and it grows unbounded, you can ever believe old stuff. With L2, you can build all the old stuff that's great. Oh, no one has the same problem. You still have this privacy issue. You'll see in the course of the trade-off, it doesn't solve that problem, because again, the watch shower would have to know what channels were, which became into before to the rest of the channels and how it closed the current state of the channel, which means they always need to see the current state of the channel, which was kind of the point to avoid. All right, watch showers are helpful, but they do some things. Okay, all right, so, even this one's fun. And I'll talk to you guys later, so. Hi, fine. Okay, so this is the end of your comment. We come to Trump to be transactions and vehicles and paying. There's so many times here. It turns out, you know, lighting security model is, I, if something happens on chain or if nature is about to expire, not only do you have to be online, but you can have to make sure you can get the transaction for an election within some time limit. You have to, maybe you have to click an nature, you'll see what we're doing next. Maybe you have to, first, close the channel and do that. Or maybe you have to, first close the channel and then, time out with HGLC. Whatever it is, you gotta get a channel on, you gotta get a transaction on the blockchain, waiting for some time, time limit. So historically, you know, really lighting, we actually fixed one of the problems on this slide, so that's good, good progress. We started with this model where we had commitment transactions, right? So in lighting here, kind of always updating the current state, and the current state is actually a broad taskable transaction, maybe you can go to the blockchain within any time. But you're only updating the fee on that channel on that current state or that current transaction when you're doing, when you're online, and when both parties are online, and both parties are accepting the new fee. But what happens is, one party is offline and the fees are going up. And there you have a time limit, and you gotta get that transaction firm, but the fees are going up and up, and the fee on that transaction is out of date, and suddenly you broadcast a transaction, but it just doesn't have enough fee. Well, you're kind of sort of, so that was really bad, but always, you know, we can't predict what the future fees are going to be. So we tried that for a while, and then actually did call some problems in practice, and so we added the same call in-groups. And so this commitment transaction has that current statement, current transaction we broadcast, the two stuff, the two remote needs, you'll see the outputs, or all the kind of the things that we're already there. It's your money, your peers money, and then the stuff for the agency. You'll see the use of these current inflate payments. Great, we know what other things. We added these anchors, so these are additional outputs on the transaction that allow you to spend and potentially do trial case for parent rights. So there's two solutions, traditionally, to the problem of, I have a transaction that doesn't have an fee, and you can get it in the blockchain now. We place my fee in rate, so we'd like ideally to take the transaction, modify the transaction, assign it to our feature in, and announce that. We can't do that because these transactions are co-sign, if you're carabring, if you're carabring, if you're carabring, if you're able, or they might simply be offline, so we can't do our BFB, but you can still do channel-paste with parent. So that means we create two transactions. One transaction spends the other transaction. This one has lots of fee, this one has very little fee, but that's okay. We can go and look at that and say, oh, we're fine. Both of these, I get a still-taste fee, but I have to include both in order to get this high fee. So if you're on group smart, I can do that. It's great. This is available in me. Most lighting and momentations. We're still working on it, and it gets default in some, not default in other groups of AND, and the logic to actually construct this transactions, which is super complicated, and so it's still kind of working progress, and it gets super robust, but okay, great. This works with dairy. Much of pretend that works with practice, I don't know if it's good with cows or something. Great, great, great, great. Yeah, and then you can actually go into the temple. So what if, what if, let's just spit ball here, instead of you grossing your current state, your car or party rent has their current state, and they do this anchor thing, and it's really cool that something's in a lot of few things, just don't put lots of few stuff. So now this whole thing, this whole, like, multi transaction packages, even then pooled, it's sitting there, and it actually doesn't have lots of fee, so it's still low fee, and it's not going to confirm what we do. Well, okay, we've got the second interviewer, this anchor is our anchor, we're allowed to spend this one. We can construct our transaction, but we don't. No, it's in the temple. You don't know that this thing is there. Man pool is not, there is no one, there are individual man pools under different nodes. There are various things you can do to cause nodes to have different man pools, that's fine, that's how Bitcoin works, that's why we have blocks. If everyone had the same number, we would never need to block, because we all are reading on what the current transactions are. So just the minus of. So we have to, we don't know what's necessarily in the the medical, the minus, maybe we know what's in our mental, but that's not so useful. We don't know how to wish transaction is where to construct our. our anchor spends. So, that's hard. Okay, so, sorry, that's that's our mental. Let's just call our transaction that we have on the last slide, our version of it, our local commitment transaction, and let's just send them to our package, let's let's through that, our Bitcoin core node, and that has higher fee. So, like, no shoe except that instead, we have to send up Bitcoin core just isn't that smart. So, there's no way currently in Bitcoin core to hand it two transactions of once and say, hey, I believe you have some other transactions in your mempool. You should take both of those transactions and throw them out or place them with both of these transactions. You can do it in the RPC, but not over the peer-to-peer network. So, this is what we need to solve this problem. Gloria, who I think actually just got a plane and left, has been working on proposals to Bitcoin core to add support for being able to do that, for being able to hand it two transactions at once. And great, so once we get back, we'll be able to do secure anchors, all problems with transactions getting into the blocks, our sole of it. I don't know, cracked this other problem. What if instead of lots of, instead of just doing little fees, they've also been lots of science, what if the transactions really be, like, you know, hundred kilobytes, and then there's another transaction based on it. That's another hundred kilobytes, and there's just like a ton of crap in the amount of gold that our counterpart put there. Okay, so that's fine. We can still order our transactions, actually still hire a fee rate, hire a fee rate, mine, or should they be preferent, and they should still preferent, but Bitcoin core also has anti-native service rules. So, if you were to just sort of relay our other package, and Bitcoin core, this would be a trivial denial of service attack on Bitcoin core, it was just general, because here's the R-excepting, these very large transactions relaying the amount to each other, validating these large transactions, waste in a much bang waste, and then replacing them in the very small transactions. So, if you simply blindly accepted this with, allowing our earlier transactions to replace our counterpart, is very large package, then you would open Bitcoin core notes up to the wasting and top bandwidth, and wasting potentially a lot of CPU resources, with, did not actually pay a fee. So, Bitcoin core has this concept, that there should be no free relay in replacement rules, or in any transaction broadcasting. So, basically, that you should have to pay at least one Satoshi review by, for every amount of, for every fee bite or the transaction data that you probably need to the network. So, that means, when we replace this big package, with smaller stuff, we need to pay for all of the relay of the big package in order to replace it, because otherwise, it would be free relay. So, that sucks, because now we're counterparty, you can make us pay a lot of fee, to replace their package, and we don't even know that it's an event, also we don't know that we have to do this, to have to pay a lot of fee or replace their package, and now we're part of our party, just to store it in this for money. So, that's not ideal. Either, to avoid the rest of the weekend, she has another proposal to also address this issue, we have another change to Bitcoin for. I think now we call it transaction version 3. So, what we're going to do is we're going to say, okay, Bitcoin version, and add a little special utility for lightning. We're going to work this, these commitment transactions that both parties sign off on as transaction version 3, with the little version 3 on the top. And then the Rapparty-Snello units, sort of Rapparty will no longer be allowed to broadcast very large descendants of our commitment transaction, and suddenly it's a backwards way. Sadly, so it's important to note that any denial of service on this Bitcoin core will allow this kind of attack, or most denial of service limits a Bitcoin core might allow this kind of attack. So, it's not just a science, it's also a number of transactions here, it's also very, it's other constraints that Bitcoin core does to make sure they don't get to denial of service attack, have these kinds of issues. And so, we need really to tick first and free to just say, like, you can only construct the package that looks like this, so like, very limited, and then allowing us to replace it. So, hopefully that's all of our issue, and we can finally get transactions into the blockchain, unless everyone's trying to get into the blockchain at the same time, and I don't know what we'll be doing there. Yeah, so, I mean, most of you are probably using the Global Flutting Loop paper, there's various names for this type of attack, different specific styles of the type of attack, but basically if you hold a bunch of issues, you'll see as a bunch of different nodes have to close the course of the channel at the same time, and there's only so much block space, and how do we get all those channels on the chain? Yeah, I don't know. So, this is one of those longer-term problems that we don't really have a great solution for. There's various proposals. You can have some kind of self-fighting, maybe a very working Bitcoin, where you can like prepay for block space, and then you can like prepay and then like have guaranteed block space to do in the future, then probably doesn't work because you'll just open up all the Bitcoin core nodes in the mail. Service attacks, and can do that. Maybe you can like have some ways scale the time delays, or it's we have these delays in lightning, where it's like this HTLT expires with this block height, and we have to make sure we can get our commitment transaction into the blockchain before that block height. Well, maybe we can make these numbers scale. There's a lot of the mental health backlog, because a lot of sub-goingly with the blocks, maybe we can upload those numbers to grow a little bit, and not clear exactly how you do that. There are some proposals that they probably rely on. Other earlier changes to Bitcoin, all of these requirements are kind of Bitcoin fork. There's not kind of a way to do it manually. So that's much longer term concern, and I'm very exactly how we should solve it, but probably it's somewhat okay, something self-fighting, I guess, hopefully maybe some of us are good idea. In conclusion, currently just do not open channels and people you don't know, that's an idea. You might get your money stolen, early stone up in channels, but someone you don't know, who is like really motivated to steal your money, and there's gonna be a lot of code to do it, because they can probably definitely steal your money. All right, so we've solved the blockchain problem, we can get transactions into the blocks, and great. You know, lightning is this great source router thing, so that means the center of the payment is just a route that is gonna take through the network. And this is really great for privacy, because we're not just like telling everyone along the right route, we're just came and saying go to, because that would tell everyone what our payment flow is, and they would be able to learn all kinds of information about who's receiving how much money. So instead, we just say, like the no-trip and learning anything more than the place it came from, place it came from, and place it came from, and place it came from, and place it came from, and it's going to, and so we could create this, you don't even have to select the path. Uses it turns out, and I didn't notice, usen actually expect payments completely quickly. I thought they were fine with 10 minutes. I wasn't entirely sure I were doing this lightning thing. They, they, they like a hundred milliseconds, which I don't, people are impatient, I guess. I don't know. But if you want those times, if you want that like thing that the user experience, people keep telling you that they want that first route past the work. A, do the second one. Maybe you can be sure the payment wants, but really that first route past the work. And so how do you pick a route that is going to work? How do you make sure that the route you pick through the lightning network is actually going to get the payment there, every no-trip path has enough available to pass it into the channel, and the payments can go through on the first try and it can have quickly. There's a ton of real doubt there. There's, you know, there's like, uh, plump-dent folks have done all kinds of different ideas for how to optimize the no-tripable channels, like, however, the no-tripable and it turns out a lot of them kind of like spawn it up and then go busy with life, and forgot about it and like all the channels are constantly saturated, and your payments will never work going through those channels. So probably, of course, those numbers, I guess I don't know how you learn who those nodes are, right, so you start up and know who you open some channels, like, I'm gonna read this payment, it's gonna be great. I'm gonna send it somewhere, and like, half the network is nodes with a channel or all entirely saturated because they're completely on maintain, and so how you pick a route that's gonna have high success rate because every time you take a half, you have a chance of half or something that the payment goes through, yeah, that's great. So maybe that one of the sort of benefits, or maybe you ask a server or you say, like, hey, what's the boss or a fellow of these channels? Or maybe you, you know, you ask a server, like, hey, which channels have high success rate, how often does the, the these payments fail? Maybe you start probing a lot, maybe you just send a lot of probes up there, you try a lot of paths all the time, even though, you know, they're gonna fail, and you're gonna waste all of the lightning networks resources here in the denial of service attack, or collating that one, can take the network down. But your payments may succeed, and so we're also probing when she is just rude. Oops. Okay, well, all right, the real, well, we'll do some squirts, we'll get squirting there for somewhere, and we'll keep track of which payments to see failed, which has our payments go down, and which shows our reliably able to grab payments. This is great what that ends up measuring, so in fact, what most clerks don't do, you know, most, I'm sorry, I'm sorry, I'm sorry, I'm not those clerks, most most notes do. They keep track of reliability, all the payments, all the channels in the network, and we just strongly prefer to use channels that seem to be reliable. What this ends up measuring is which notes are actually rebalancing their channels, and keep you channels to be balanced, and then you're just strongly prefer all of those channels, which is a whole separate debate. There's an ongoing debate in the laying world about if rebalancing is good, or if rebalancing is a pector or something, if you're rebalancing your channels, pushing that imbalance onto other people's channels, and causing them to be not able to grab payments and some view. It's, these most regulations need better understanding of the lighting network dynamics, and some cases, yes, and some cases of any value. So, that's not ideal either, but it certainly gives you payments to succeed. If you're strongly prefer these notes that are always rebalancing, okay, but then we're also only rebalancing, which is rebalancing, which is rebalancing, which is rebalancing, which is rebalancing, which is that mean that our pregnancy is lost again, because we're only rebalancing over a very small sub-graph, we're not rebalancing over the entire label graph, we're strongly prefering other path, certain paths when we're not working, we're going to rebalancing a minute, but potentially in search. Well, you know, also, even if we have a algorithm that tells us which shows our rebalancing, we're going to strongly, for those channels, what are these notes and there are many of them that have acceptable amount of payments, we'll see a lot of them on our large shows and set channels. Everyone, so they have a thousand channels, and every single one of those channels is always completely saturated to them, how can they help you, they just can't help you. So, that's also when you shoot, you know, you can't rebalance cheaply or easily through, you know, if you're one of the peers of this note, that regularly gets almost all of its capacity, pushing in one direction, it becomes harder to rebalance, you just constantly have been new channels, it's one strategy, and in fact, that's a common strategy, but certainly, when a note that just started up twice, maybe you're going to have a really great time in finding which of your thousand channels are actually having a capacity available. And so, this strategy of this like, put up a big note, plug-knit uses rural channels to you, it'll work itself out, it'll get plenty of amount of liquidity, it's not actually all that useful. In fact, you see many of these larger recipients, no longer accept the channels from everyone starting to have these channel, no imperialists, where they accept channel to life people in those teams, etc, etc. So, okay, you just only accept channels from good notes, I don't know how you just said everything, that's what it is, but funny to do that. And so, it ain't bad to put these to hard notes, so many that they will get in battle liquidity from somewhere, in order to receive payments. There are many people working on that, so, all of the problems in any of these slides, in battle liquidity is probably the most solutions and the most people working on solutions and the most different marketplaces and whatnot, that it will build great, and we don't use that too much time on that. There's still many built in, now it's not necessarily easy, that these things are like, so, you know, when are, when are you? But you know, we're running this to hard, I guess we also mentioned that, the actual solutions you're running is you're just open in channel if you're ever trying to pay. You're in large boat, that's basically what you do. You know, you're like, show it with lots of payment volume. You're just open in channel with all of your top destinations. And then it's no problem, because you're top destination, that probably everybody's top destinations and they have a challenge, channel, they're all saturated, so you don't really can't pay them. No one can pay them, but you can pay them if you just open in channel. So, the lay thing is, you know, you always only have two hops, maybe three hops in the worst case, everyone opens a channel with everyone. And lay them works great, because it totally scales, and swear I've heard scales super great. If everyone has a direction with everybody else, we'll never have any problems. Definitely also don't have to over commit the liquidity there, but that's what people do today, because that's what works. And actually fixing this problems hard, but for now, we've done what we're doing. All right, yes, so I mentioned previously, the mention where it's here few times, but how you, like, kind of, what these, like long paths, that the animals through the network, so that hopefully, don't, don't worry, we are. So let me say the little bit of context, before I go on a privacy, as you probably know, or hopefully, no channel, as all these other folks put, they, they, they, they're thick, like you speak. They have all of these great data sets for you, check-Sodes, and who potentially owns which wallets, which wallets are associated with who else, which, you, you, check-Sodes are clustered into wallets. They're actually good at this game. It's a part game to defend against, you know, they're better on it than other change, than Bitcoin, because other change are like horrendous for privacy, but Bitcoin also has its problems, and you take some of the plus things painful, but they have really great data for that. So what, they're primary motivation right now, is they want to connect their existing data set to lightning, right? So they want to be able to say this lightning mode, is this cluster of YouTube, so that I'm already identified as a wallet, and that wallet has been receiving payments from Coinbase or Cracken or whatever, and I can go ask them who it is, and then I will identify which, this two owns this lightning mode, because I know that YouTube shows. So that's, our biggest, our most immediate risk, because that's what they're doing, and what lightning does is lightning-writing notes, there's telly, entire world, which you take. So those are theirs, and telly and else is directly, hey guys, I'm just routing note that you're on my YouTube shows, so that's totally private. Definitely the thing we want to be doing right now. All right. Yeah, so that's a problem. You should fix that. So why do we do this? The DOS assistance is important in lightning. We don't want everyone to be able to come online and say, hi, I have a channel with everyone around payments through me. I have a channel with everyone around payments through me. I have a transfer of fees, so around all your payments through me, and I can see everything that's happening in the lightning, that would be bad for privacy. Otherwise, so we need some credit and all the services that we're going to be able to say, hey, I have a proof to you that I have some Bitcoin on chain. I have a YouTube show that has some Bitcoin in it. At least this is a cost, so it adds a cost to the now, a service tag in the network. So we use YouTube shows for that. So that's why it's so broken right now. So we'll start with fix this. Maybe we use zero knowledge proof, and wait a hand wave. We prove that I have a YouTube show, but I'm not telling you which one it is. That would be really great. I'm going to be back to this. It's not so okay with it, but we spent a good chunk of time looking for a good CKP system, that we just wanted to use on the shelf. They didn't really find one. That was super mature, and super going to be super mature for the next few years. Hopefully this is something that changes when coming here, so we can actually switch to easy KKP scheme for an all-service assistance here. Which, okay, fine. But, you know, maybe you gave it a neat time, you should prove balance. You should show, like, hey, I have some balance. And I can tell, you know, I can tell you all of my YouTube shows. I'm like, that's my YouTube show at every channel, which proves some balance. And maybe that's enough of the NL service assistance. Plus during we'll probably get still eager lunch. So they, you know, channel, assistants, etc. We're going to cluster in YouTube shows today, in the digital wallets. They'll probably still win, because they will be able to cluster the YouTube show we use to prove. With your other funds, it's probably going to make a little bit, so it's not. But, we can co-made a little fund, this really hard. People continually break this, probably, maybe a little bit than actually, people got from prison. You know, they did come in, co-made a little fund too much through a whole bug in a wallet. It wasn't even a fault. It was really careful. There was bug. There's fun, got co-made a little different prison. So, all right, so maybe maybe, where I didn't know it's just rude. But maybe we can present a future, whatever I'm trying to know is, well, I mean, you still have UGA, so it's a public note that public note, eventually that channel's going to get close to the fund, they're going to go to co-made the rest of their funds, and again, clusterings going to eat a lunch. So, the attacker, machine analysis in the States, you can learn, hey, these funds, was a channel that they closed with some one, the channel was announced, so it was clearly a predetional. I got co-made the rest of their funds, so I know if there's errors, I can go ask Ben, hey, there was this channel that you had open. What was the IQ to do this in your view? Even though it was predetional, I probably learned actually what it was by knocking on the door with Sapena and actually the let me down. All right, so this is, okay, so maybe maybe, maybe let's go to the U-Chakes' little part for a minute. It does complicated and maybe maybe slime. So what about inline? What about, can we have predetional inline in? So you generate invoice, and you put your public key on there, you sign it, and you can hand it to the cell on, and suddenly they know which road you are, and which you share. Two of your errors, and our shit. Okay, so receiver has no privacy, that's not good. But we have a solution for this one, where you can blend in paths. We can, in fact, do something like, familiar with, onion services, poor, skin services, poor, what actually revealed to people, is you say, hey, there's an introduction point, if you have a way for me, but if you come to them, don't know how to get to me. And you tell people that, and they talked about an introduction point, and then goes through a few more hops, and then it gets to you. And so no one can theory actually learns through their simmiages. It's great, we can do something exactly like that lightning. We can show these, we can create these paths. We can actually, probably, don't want to do introduction points themselves, but we can do, pat, we can hand the entire path over to the center. Turned up this a lot of data, we can't fit it in. So, okay, so we have this, when we're data, we're going to communicate it to somebody, ah, we have lightning messages. So we can take these blinded paths. We can actually do short-blided paths, and like do that in a QR code, but we can't include more than one, the E2, a Blided paths in a QR code, which is not a space. So we need, I mean, I just didn't even ask a word-blended paths, and then I'll give you more lighted paths, and then you can retry the payments you've time to eventually find a path that has a liquidity, ah, great growth. Both well-blended messages will get their eventually. As long as the nodes in the unemisive path like down, and if they're offline, then you just can't take it. So, ah, okay, so, maybe you can fix your super privacy. So, what about, we're having those. Turns out, if you actually sit down and work on it, there's number of good papers on this. A routing node can make you very, very good guess, all those not a guess, as to prove the sender, who the recipient of the given payment you're seeing is. Ah, this period is a bit of a guess. Uh, Turns out, in lighted, today, like I said, if everybody opens a channel with everyone, so there's only actually one of some hops, and most paths. Ah, so, you could make a pretty good guess if through the sender, and those are the NR, if you have the only hop in the path, because you're connected to the sender, and they're a signal. Ah, that's a complicated. Um, you can also make good guesses as to how many paths they went through, so there's the CLTP, those actual time locks in the, in the HGLC as, which we're driving through the network, uh, you can make, so we don't want to increase those time locks too much, because if we increase those time locks too much, right after weight, up there are a long time over the HGLC times out, um, so there's just a payment, or someone's doing a channel jam, and you can make the channel jam in the type of words, um, so if we can't increase those too much, though, then all of a sudden the NRBDN node can look at the HGLC, and immediately say, oh, this HGLC has been through, or has two more hops to the destination, and then if you look at the routing graph, you can say, ah, I know where I'm connected to, I know who's two hops away from me. Um, I know where this came from, I'm actually going to sit down and run, call me, grabbing all of them to cross all pair, all sources on the network, and all this nation's on the network, and it turns out, is generally not that many routes, so two more hops from you, that have more than, you know, water two different potential sources of this HGLC, and again, you can make a really good guess, as to who the source of this nation are. Um, so this really bad, so you can see, you know, you can put yourself in a good position where you can, for example, learn how much payment volume your competitors get in, and see their numbers before they even do. Um, so that's, you know, obviously pretty bad for a payment rail, um, if you can see your competitors numbers. Um, so, we have, it turns out this is really hard, and there's some ideas, there's some potential solutions, um, the, uh, we can randomize this healthy a little bit, hopefully that I'm proofing, some what, some those do this, some those don't, maybe all I'm to do, I hope all I'm to do, I don't know, um, but, routing is also a little deterministic right now, so the writing algorithms are a little too easy to learn, which can catch pads, so it's like taking, um, especially if you have any guests, which other nodes have on the level channel, because then you know the channel, the nodes definitely will be taking those pads, um, so you can, we can randomize the routing algorithms a little more, this is like an open academic problem, it's like how we build a routing algorithm that considers privacy a little bit, it's also not an obvious question, but something we can improve on, you just add more hops to payments, might be fault might improve things, but we have to balance that up for us again, success rates and users who want payments completely, um, so it's not clear exactly how you do this, but maybe we can make some progress, um, yeah, so, it's also important to note that, you know, lighting is a great thing, uh, e-jarral, and that works like lighting, like tour, um, these, low latency, forwarding networks, what you're really trying to do is you're trying to hide the noise, um, if you're, or routing node, and you see, you know, 100HGLC that once, um, you might have a little less idea of, which use shield C is a correlated with what other payment flows, so you might not know that, like, for example, if someone's making a payment once a week, from their nodes would give an destination, if you monitor your lighting node, over the course of a few months, you might be able to, eventually identify exactly that there is someone making this payment once a week, from this source to this destination. Um, but if there's a lot of noise, there's a lot of other payments, maybe you can hide it, but it's always a little better. Um, this only works so well, if payments are moving very quickly, this is only so many each shield Cs, um, e-m-e channel at once, if, for example, uh, you read two nodes, you correlate two different H shield Cs, or is only actually one H shield Cs on that, those nodes, um, e-m-e-t-l-cs, c-t-l-cs, c-t-l-cs, obviously, because they should, they should, um, but, you know, if you're right, two nodes, you might not learn that they're the same payment, but only if the, uh, e-s is a lot of other payments going on at the same time. So this one actually has a really easy solution, more people just need to use lighting. Um, more noise, more noise good for privacy, um, more people need to use lighting, tell your friends to use lighting, so that you get to privacy. Easy. Um, one lesser privacy, uh, turns out, uh, balanced programming today is like really easy, so without even probing, like literally just from monitoring, there's successes and failures. At some point, I downloaded it, but I got access to catch apps, you know, obviously catch apps into each other payments. Uh, got access to catch apps, data on their predictions for the balance range of one of my channels, and it was accurate to within a few months' access. So they had an almost exact understanding of what the balance in my channel was at that given time to very, very low to very very my accuracy. Um, and if you can do this in mass, which in fact, can probably, um, then you can watch payments flow through the network. Right? You know that these three channels, suddenly had their balance shift in one direction by one million sets, then you can make it pretty damn good. Yes, that one million sets payment, just flowed those through those channels. Um, so this is, this is really bad. Um, it turns out there is some easy things we can do now to improve this. Uh, there's probably more things we need to seriously consider later. Um, there's this idea called the Oakland protocol, just because it was created in Oakland and engineers about it. And many things. Um, so if you're operating a lighting node, there's a strippiest idea in hopefully, a setting for the max HDLC in flight. I mentioned it earlier because if you reduce this number, it means you have lower risk. If you go offline and you have to use your watch tower, who should reduce this number? Because it also improves everyone else's privacy when grabbing for you. Because you can hide what the actual channel's balance is, because users are only able to probe up to the max HDLC value at flight. And if yet max HDLC value at flight is less than your channel's current balance, then users are only able to probe you, at least as easily there's some other way to take a probe. But at least it makes it harder. Um, so you should change that number. If you're lighting a implementation is not default to less than half the channel value, you should mad your lighting and check implementation that changed the default to less than half the value. And if you're around him, if you're a node-sending payment, you should prefer to rent through nodes that are setting this value to less than half the channel value because it proves your privacy and cash out. Does this, it's only very small amount, but it does this, so you might need more grabbing revenue because some nodes prefer to route through your channel if you set this value to less than half the channel value. So, good end. Um, so I'm out of time. I've been out of time for a while, but there's also a slide on channel gaming. And, I don't know. I got nothing to do with it. Uh, I can't do it anymore. I can't do it anymore. You're the one. Um, I'll quickly run through this. Um, so the basically integration for channel gaming, as you know channel gaming, as just sending it much to HDLCs, sending out them, not letting them expire, and causing the internal work to no longer be able to route payments because it's just pending HDLCs everywhere. It can only have so many many HDLCs in the channel, and suddenly, you know, when I was going to payment through, um, it's basically two directions to addressing this. Uh, it's more recently got a bunch of research. Um, either upfront payments, so users have to pay money up for it to grab a payment before that you ignore whether it's disease or fails. Um, so this has the problem of life. Is the fee given enough to, compensate to increase the cost of the attack, so that users can't do this, and our payments, etc. and stuff that users are going to get pissed off because the payment fail, and these still have to pay the fee, just like the internet. Uh, so, uh, the other approach, uh, people are considering is for politicians or something, so, uh, maybe you, maybe you pay up for payments sometimes, but if you've been doing a lot of payments, you can get some blind atop in, and you can use that to say, hey, hey, I'm someone who's been doing a lot of payments to trust me, and then there was trust you. Um, there's also, uh, if I didn't finish, you'll see it's been waiting too long, and it has hit the, and it hasn't, uh, been expired, that you prove that a channel went to change, you've shown that you actually spend a lot of money in this country, and it's a lot of money, and it's a lot of money. And then, your applications burden, uh, there's a number of things that there's a number of research papers trying to cost out the, you know, how bad the user experience risk is, how I fees are, how much it prevents the attack, um, so, need more research, uh, there's been a ton of great research on this, very recently, and I'm going to thank you, I am an optimist, I swear to God, I still love like my English, but thank you. Thank you. Thank you. Thank you. Thank you. What's due to Q&A real quick, blue? That's the button. There we go. Okay, um, I would like to question for you, this one, and the way in the industry, when can we know what the channel is like, people who we don't necessarily know they are like cool, on these tiny, no-anylices, and it's like, oh, that guy has, well, like, channels and stuff, maybe, maybe that guy's cool. Is there going to be a point, and then you're, you know, future, where it's like, hey, like, I can go a little bit more comfortable, and take up with like, random, that's simple, like, for me, maybe, or something. Yeah, we need to fill up this. Yeah, I mean, the first three issues, I think we have good ideas. And the first one, we've got code for today, and in most lighting implementation, it probably kind of works. The second two issues, this changes coming out of the right line for Bitcoin Core, and you get those, hopefully, soon-ish, you know, and it's year or whatever. So that's also very, very, tractable, I think, maybe the optimistic about those, the issues. And that's kind of the immediate risk, from someone who's just trying to be an artist, and like, do some of these opinions, as I said, I don't know, small scale, so I'm optimistic about that, and like, the year or half fish timeline, type red, maybe more, or else, and it won't be a business scope either. There are few years of what I've heard. Three years, three years. In the large-scale one, is concerning that, doesn't have a clear solution. Hopefully, it's something that, you know, is mitigated by analyzing, seeing whether someone is, is opening wage-winning channels before, before it happens. I'm clear how practical that is, but it's not even an attack against you, without point, it's just with everyone. So, yeah, I mean, the large-scale closure thing, this is really concerning. I don't have the good answer, but that's your point. Next year, by next year, I'll go. No, next year, doc. Oh, we can talk about next, on the 2020, yeah, we'll come with a new solution. All the way to the 2020, yeah, but, yeah, the name of the question about the world-crafted, sarcasm, that had a very nice presentation. The name of the way, was like, oh, it was a mean series of that point, I actually know, since I'm starting there. It's where I... Yeah, the inspirations, good, like, oh, sorry. That's it. That really question, but now to the end. Yeah, it's easy. You can just reverse all the payments, and the virtue of your group, and consumer is protected, it's fine. Well, unless it's the new, what's the new one, the... the... the... the... the... the... the... the... the... the... good luck. Good luck. Good luck. Good luck. Good luck, question, very important. Yeah. Okay, good luck. Good luck. Thank you. Thank you. In the mass clothing case, the producing issue, he'll see you explain to help you, or is that some other... Does... Wait, that was... What's your personal risk of the mass closure again? That... that if the attacker has the channel has one of the channels with you that you need to type out the HClC before they can claim it on some other. It's a great spray. They also have the other transactions. For those rounds back to minimizing HClC-excilter. It's also because they can broadcast the sales date and then if they're managed to deliver to our clients that way, but if they manage to deliver to the full day, then they could be theoretically taken to fund at that point. Okay, the main issue is, my signature book, which is in the book, is you do up the maximum amount of shipping documents that you've been receiving. Please, like, ink hunting and if you're creating for a painting to the bank. So in the member back drug is either the new issue, you're not going to be in the number of issues you've got in the flights, but the max of shipping documents are not enough to get into this new backlog as somebody is like, your shares you're not going to get into the bank before expiration of the contracts. So you have those three in the store. She's looking really, really, really happy to have the new contract. Can you summarize that for me? That's what I'm going to do. So one issue we have to point it out is that when you're doing these kinds of interest fans, this is the simple break, this is the thing with funding. Happy to sell you reserve. If you keep on James, you have an on-chain wallet with some extra funds to do these few bumps. So you only have certain out of funds. You want to keep those to your funds even like where you can. We can keep some amount of funds in your fee bumping reserve. How much, you're all going to have some amount. If the mental gets very congested, you're going to have eventually run out. If you go up, but yeah, and then you won't be able to need a transaction to earn quick enough. Or if the agency will see this, right? Not even worth spending that much fee, just break it off and then you floss money and wear another. Is that close? I'm going to question that over here. Amazing talk. Do you think that zero or time-resigning funds from zero-competition channels? The Poppeterizations are a complex channel, a slid-up of credit. I think third-competition channels are almost, and I hope exclusively you can use your wallet, so you can use your wallet to connect to an LSP operated by your wallet vendor. I think it's kind of outside that the issues here, because it's really just always your wallet vendor. If you're all of that, you really want to distill money from you, they really could. They can just ship it up date. And your phone will automatically pull the KMAP and just send it in your private keys. So I'm not like super concerned about it. There's a lot of regulatory questions about it. You don't want to have very large risks. I mean, I yielding people to run open source software. Not a mobile phone, either there's a huge challenge with open source software, mobile phones, because you're just downloading the binary, and the apps are running, you don't actually know whether it matches the source code you're running. So there's a number of, I think, more immediate challenges that make that a less interesting, good-served, and it's hard to pass up UX. It's just, you know, users and that, it's a payment feed-o-l even on first, especially on first-served-up. So it's great off. But yeah. I had a quick question on with Taro and basically stable coins and newly minted coins, operating on top of lightning. What your overall opinion is on that, you see that potentially leading to it called being or conducting the lightning network for its primary purpose of just simply routing sets or do you think it'll start on the peripherals and just see how it plays out what the users prioritize, just your overall opinion. Yeah. I mean, I don't, I have no idea how it's going to play out. I don't see why it would cause issues within the lightning network. It at least it just deploy as current in the sky and maybe easier to deploy as a parallel network. But if this deploy is current in the sky and where it's, you know, you really have a channel with the market maker and then they turn it into a bit quiet and then it can forward it through. You know, I don't want to see why this would be a concern to be existing like this. So it will be existing like lightning ramping nodes or anything. You're not really necessarily going to be exposed to much of what people are trying to take advantage of the option implied in that. You can see a lot more stuck, HDLCs for a while, but I don't think I'm really concerned about it's an act perspective. Yeah. I want to ask a last question. Do you foresee any like the image and cash effort earlier? Like, do you see any kind of like meat space kind of agreements that are going to maybe it popular as like a stand and even as a long term thing with white ink partners or channel partners? What do you think that's kind of like against the ethos of the space? Like, there is no implied, you know, if you know who your kind of party is and they broadcast the sales transaction and do a painting attack against you, I think you have a very, very kind of case in front of the judge. I'm not a lawyer, but judges are humans and they see the reality of, you know, they're not technical. They're not going to sit there and like parse out some technical bullshit argument about how it's just in the system and like it's in the rules of the system and it's fine. Like, they see reality in front of them, they're reasonable people generally. So whether you have agreement or not, I would imagine you probably don't want to perform some of these attacks of people who you are because you might very well lose a lesson. So as far as gossip with a should know, a lot of like there's bandwidth with like we're adopted messages and stuff, I believe there's research in many sketch. Are there any other solutions for cleaning out gossip relay? I don't like to hear. Is it poorly? Guys, working on this, I don't know. Here. I'm going to give you a shit from this in my tongue. Yeah, I think these that some research on, some of the highlighting folks have done some research on using many sketching lighting gossip. There was something that they asked you. There were a few different approaches we could take. We had a little bit of back and forth on it. I don't know where they landed, but it probably does something that will happen eventually to be right gossip to you, something like any sketch. Hopefully that reduces the back of the cost a lot. Thank you so much, man. Thank you.
